;18649 Fall 2013
;Team 18
;Yi Huo (yhuo)
;Mustafa Bilgen (mbilgen)
;Sairam Krishnan (sbkrishn)
;Abhijit Lele (alele)
;
;Integration Test - 12A

#INCLUDE defines.mf

;set up preconditions
;Car is at floor f and stopped and all doors are open
0s I DOOR_OPENED_SENSOR_PERIOD N DOOR_OPEN_SENSOR_[FRONT][LEFT]_CAN_ID DoorOpened FRONT LEFT = true
0s I DOOR_OPENED_SENSOR_PERIOD N DOOR_OPEN_SENSOR_[FRONT][RIGHT]_CAN_ID DoorOpened FRONT RIGHT = true
0s I DOOR_OPENED_SENSOR_PERIOD N DOOR_OPEN_SENSOR_[BACK][LEFT]_CAN_ID DoorOpened BACK LEFT = true
0s I DOOR_OPENED_SENSOR_PERIOD N DOOR_OPEN_SENSOR_[BACK][RIGHT]_CAN_ID DoorOpened BACK RIGHT = true
0s I DISPATCHER_PERIOD N DESIRED_FLOOR_CAN_ID DesiredFloor = 1 UP BOTH
0s I DISPATCHER_PERIOD N DESIRED_DWELL_[FRONT]_CAN_ID DesiredDwell FRONT = 2
0s I DISPATCHER_PERIOD N DESIRED_DWELL_[BACK]_CAN_ID DesiredDwell BACK = 2

;#arc '1a'
0.50s I AT_FLOOR_PERIOD N AT_FLOOR_[1][FRONT]_CAN_ID AtFloor 1 FRONT = true
0.50s I AT_FLOOR_PERIOD N AT_FLOOR_[1][BACK]_CAN_ID AtFloor 1 BACK = true

;car should be stopped
1.20s I DRIVE_CONTROL_PERIOD N DRIVE_COMMAND_CAN_ID DriveCommand = STOP STOP

;#arc '2a'
3.50s I WEIGHT_PERIOD N CAR_WEIGHT_CAN_ID CarWeight = 20000
3.50s I DOOR_OPENED_SENSOR_PERIOD N DOOR_OPEN_SENSOR_[FRONT][LEFT]_CAN_ID DoorOpened FRONT LEFT = false
3.50s I DOOR_OPENED_SENSOR_PERIOD N DOOR_OPEN_SENSOR_[FRONT][RIGHT]_CAN_ID DoorOpened FRONT RIGHT = false
3.50s I DOOR_OPENED_SENSOR_PERIOD N DOOR_OPEN_SENSOR_[BACK][LEFT]_CAN_ID DoorOpened BACK LEFT = false
3.50s I DOOR_OPENED_SENSOR_PERIOD N DOOR_OPEN_SENSOR_[BACK][RIGHT]_CAN_ID DoorOpened BACK RIGHT = false

;#arc '3a'
5.01s A F DoorMotor FRONT LEFT : command == OPEN
5.01s A F DoorMotor FRONT RIGHT : command == OPEN
5.01s A F DoorMotor BACK LEFT : command == OPEN
5.01s A F DoorMotor BACK RIGHT : command == OPEN

;#arc '3b'
5.50s I DOOR_OPENED_SENSOR_PERIOD N DOOR_OPEN_SENSOR_[FRONT][LEFT]_CAN_ID DoorOpened FRONT LEFT = true
5.50s I DOOR_OPENED_SENSOR_PERIOD N DOOR_OPEN_SENSOR_[FRONT][RIGHT]_CAN_ID DoorOpened FRONT RIGHT = true
5.50s I DOOR_OPENED_SENSOR_PERIOD N DOOR_OPEN_SENSOR_[BACK][LEFT]_CAN_ID DoorOpened BACK LEFT = true
5.50s I DOOR_OPENED_SENSOR_PERIOD N DOOR_OPEN_SENSOR_[BACK][RIGHT]_CAN_ID DoorOpened BACK RIGHT = true

;#arc '3c'
6.51s A F DoorMotor FRONT LEFT : command == STOP
6.51s A F DoorMotor FRONT RIGHT : command == STOP
6.51s A F DoorMotor BACK LEFT : command == STOP
6.51s A F DoorMotor BACK RIGHT : command == STOP

